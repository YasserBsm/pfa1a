<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajouter une action | PortfolioManager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5e6d8 0%, #f8ece2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        .navbar {
            background-color: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 15px 0;
            width: 100%;
        }
        
        .navbar-brand {
            font-weight: 600;
            font-size: 1.5rem;
            color: #333;
            display: flex;
            align-items: center;
        }
        
        .logo-circle {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #FF6B6B 0%, #4A90E2 100%);
            border-radius: 50%;
            margin-right: 10px;
        }
        
        /* Style pour la page d'ajout d'action */
        :root {
            --primary-color: #6c5b7b;
            --secondary-color: #9c8aa5;
            --text-color: #333;
            --btn-primary: #4A45E5;
            --btn-hover: #3f3bc4;
            --btn-danger: #e74c3c;
        }

        .btn-primary {
            background-color: var(--btn-primary);
            border-color: var(--btn-primary);
            border-radius: 6px;
            padding: 0.5rem 1.5rem;
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: var(--btn-hover);
            border-color: var(--btn-hover);
        }
        
        .btn-danger {
            background-color: var(--btn-danger);
            border-color: var(--btn-danger);
            border-radius: 4px;
            padding: 8px 15px;
            font-weight: 500;
            transition: all 0.3s ease;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .container {
            max-width: 1200px;
            padding: 2rem;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        h1 {
            color: #333;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #555;
        }

        .form-control, .form-select {
            border-radius: 8px;
            border: 1px solid #ddd;
            padding: 0.75rem 1rem;
            margin-bottom: 1.25rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(226, 77, 48, 0.15);
        }

        .summary-box {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .summary-box h5 {
            margin-bottom: 1rem;
            color: #555;
        }

        .back-link {
            color: var(--btn-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            font-weight: 500;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: #777;
            font-size: 0.9rem;
            padding-bottom: 20px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 20px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar du dashboard -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid px-4" style="max-width: 1200px;">
            <a class="navbar-brand" href="/">
                <div class="logo-circle"></div>
                PortfolioManager
            </a>
            <div class="d-flex">
                <a href="/logout" class="btn btn-danger">Déconnexion</a>
            </div>
        </div>
    </nav>

    <!-- Contenu principal -->
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <h1>Ajouter une action à votre portefeuille</h1>
                    
                    <form method="POST" class="mt-4">
                        <div class="mb-3">
                            <label for="action_name" class="form-label">Nom de l'action</label>
                            <select id="action_name" name="action_name" class="form-select" onchange="updateFields(); updateSummary();" required>
                                <option value="">--Choisir une action--</option>
                                <option value="AAPL">Apple (AAPL)</option>
                                <option value="MSFT">Microsoft (MSFT)</option>
                                <option value="AMZN">Amazon (AMZN)</option>
                                <option value="GOOGL">Google (GOOGL)</option>
                                <option value="TSLA">Tesla (TSLA)</option>
                                <option value="META">Facebook (META)</option>
                                <option value="NVDA">NVIDIA (NVDA)</option>
                                <option value="NFLX">Netflix (NFLX)</option>
                                <option value="INTC">Intel (INTC)</option>
                                <option value="CSCO">Cisco (CSCO)</option>
                                <option value="KO">Coca-Cola (KO)</option>
                                <option value="PEP">PepsiCo (PEP)</option>
                                <option value="NKE">Nike (NKE)</option>
                                <option value="MCD">McDonald's (MCD)</option>
                                <option value="WMT">Walmart (WMT)</option>
                                <option value="BRK.B">Berkshire Hathaway (BRK.B)</option>
                                <option value="V">Visa (V)</option>
                                <option value="MA">Mastercard (MA)</option>
                                <option value="ADBE">Adobe (ADBE)</option>
                                <option value="CRM">Salesforce (CRM)</option>
                                <option value="AMD">AMD (AMD)</option>
                                <option value="BA">Boeing (BA)</option>
                                <option value="F">Ford (F)</option>
                                <option value="GM">General Motors (GM)</option>
                                <option value="DIS">Disney (DIS)</option>
                                <option value="PFE">Pfizer (PFE)</option>
                                <option value="JNJ">Johnson & Johnson (JNJ)</option>
                                <option value="PG">Procter & Gamble (PG)</option>
                                <option value="UL">Unilever (UL)</option>
                                <option value="SHEL">Shell (SHEL)</option>
                                <option value="CVX">Chevron (CVX)</option>
                                <option value="XOM">ExxonMobil (XOM)</option>
                                <option value="TTE">TotalEnergies (TTE)</option>
                                <option value="MC.PA">LVMH (MC.PA)</option>
                                <option value="NESN.SW">Nestlé (NESN.SW)</option>
                                <option value="ROG.SW">Roche (ROG.SW)</option>
                                <option value="NOVN.SW">Novartis (NOVN.SW)</option>
                                <option value="SAP">SAP (SAP)</option>
                                <option value="VOW3.DE">Volkswagen (VOW3.DE)</option>
                                <option value="BMW.DE">BMW (BMW.DE)</option>
                                <option value="SONY">Sony (SONY)</option>
                                <option value="TM">Toyota (TM)</option>
                                <option value="BABA">Alibaba (BABA)</option>
                                <option value="0700.HK">Tencent (0700.HK)</option>
                                <option value="005930.KS">Samsung (005930.KS)</option>
                                <option value="066570.KQ">LG Electronics (066570.KQ)</option>
                                <option value="QCOM">Qualcomm (QCOM)</option>
                                <option value="AVGO">Broadcom (AVGO)</option>
                                <option value="T">AT&T (T)</option>
                                <option value="VZ">Verizon (VZ)</option>
                                <option value="CMCSA">Comcast (CMCSA)</option>
                                <option value="PYPL">PayPal (PYPL)</option>
                                <option value="SQ">Square (SQ)</option>
                                <option value="UBER">Uber (UBER)</option>
                                <option value="ABNB">Airbnb (ABNB)</option>
                                <option value="SPOT">Spotify (SPOT)</option>
                                <option value="ZM">Zoom (ZM)</option>
                                <option value="SNOW">Snowflake (SNOW)</option>
                                <option value="PLTR">Palantir (PLTR)</option>
                                <option value="COIN">Coinbase (COIN)</option>
                                <option value="MRNA">Moderna (MRNA)</option>
                                <option value="BNTX">BioNTech (BNTX)</option>
                                <option value="RIVN">Rivian (RIVN)</option>
                                <option value="LCID">Lucid Motors (LCID)</option>
                                <option value="SNAP">Snap (SNAP)</option>
                                <option value="PINS">Pinterest (PINS)</option>
                                <option value="SHOP">Shopify (SHOP)</option>
                                <option value="SE">Sea Limited (SE)</option>
                                <option value="ADYEY">Adyen (ADYEY)</option>
                                <option value="ASML">ASML (ASML)</option>
                                <option value="PHG">Philips (PHG)</option>
                                <option value="HEIA.AS">Heineken (HEIA.AS)</option>
                                <option value="BUD">Anheuser-Busch (BUD)</option>
                                <option value="GSK">GlaxoSmithKline (GSK)</option>
                                <option value="AZN">AstraZeneca (AZN)</option>
                                <option value="SAN.PA">Sanofi (SAN.PA)</option>
                                <option value="UBSG.SW">UBS (UBSG.SW)</option>
                                <option value="CSGN.SW">Credit Suisse (CSGN.SW)</option>
                                <option value="BNP.PA">BNP Paribas (BNP.PA)</option>
                                <option value="GLE.PA">Société Générale (GLE.PA)</option>
                                <option value="AIR.PA">Airbus (AIR.PA)</option>
                                <option value="SAF.PA">Safran (SAF.PA)</option>
                                <option value="BN.PA">Danone (BN.PA)</option>
                                <option value="ENGI.PA">Engie (ENGI.PA)</option>
                                <option value="VIE.PA">Veolia (VIE.PA)</option>
                                <option value="ORA.PA">Orange (ORA.PA)</option>
                                <option value="EN.PA">Bouygues (EN.PA)</option>
                                <option value="MT">ArcelorMittal (MT)</option>
                                <option value="VALE">Vale (VALE)</option>
                                <option value="PBR">Petrobras (PBR)</option>
                                <option value="ITUB">Itau Unibanco (ITUB)</option>
                                <option value="BBD">Bradesco (BBD)</option>
                                <option value="0241.HK">Alibaba Health (0241.HK)</option>
                                <option value="JD">JD.com (JD)</option>
                                <option value="3690.HK">Meituan (3690.HK)</option>
                            </select>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="quantity" class="form-label">Quantité</label>
                                    <input type="number" id="quantity" name="quantity" class="form-control" min="0" onchange="updateSummary()" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="price_per_unit" class="form-label">Prix par action (€)</label>
                                    <input type="number" id="price_per_unit" name="price_per_unit" class="form-control" step="0.01" min="0" onchange="updateSummary()" required>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="dpa" class="form-label">Dividende par action (€)</label>
                            <input type="number" id="dpa" name="dpa" class="form-control" step="0.01" min="0" required>
                        </div>

                        <!-- Résumé de la transaction -->
                        <div class="summary-box" id="transaction-summary">
                            <h5>Résumé de la transaction</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Action:</strong> <span id="summary-action">--</span></p>
                                    <p><strong>Quantité:</strong> <span id="summary-quantity">0</span></p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Prix unitaire:</strong> <span id="summary-price">0.00</span> €</p>
                                    <p><strong>Montant total:</strong> <span id="summary-total">0.00</span> €</p>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-12">
                                    <p><strong>Dividende annuel estimé:</strong> <span id="summary-dividend">0.00</span> €</p>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-primary">Ajouter à mon portefeuille</button>
                        </div>
                    </form>

                    <div class="text-center mt-4">
                        <a href="/view_portfolio/{{ portfolio_id }}" class="back-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
                            </svg>
                            Retour au portefeuille
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>PortfolioManager © 2025</p>
        </div>
    </div>

    <script>
        const actionPrices = {
            "AAPL": 145.3, "MSFT": 310.5, "AMZN": 125.6, "GOOGL": 135.2, "TSLA": 220.4,
            "META": 280.7, "NVDA": 450.2, "NFLX": 370.3, "INTC": 33.5, "CSCO": 48.6,
            "KO": 62.1, "PEP": 172.5, "NKE": 110.8, "MCD": 275.4, "WMT": 155.7,
            "BRK.B": 360.9, "V": 240.6, "MA": 375.8, "ADBE": 530.3, "CRM": 215.7,
            "AMD": 110.3, "BA": 200.6, "F": 12.8, "GM": 32.5, "DIS": 90.2,
            "PFE": 38.7, "JNJ": 160.4, "PG": 150.9, "UL": 55.6, "SHEL": 60.4,
            "CVX": 160.2, "XOM": 105.1, "TTE": 62.5, "MC.PA": 800.0, "NESN.SW": 115.0,
            "ROG.SW": 270.0, "NOVN.SW": 90.0, "SAP": 140.0, "VOW3.DE": 180.0,
            "BMW.DE": 105.0, "SONY": 90.0, "TM": 140.0, "BABA": 80.0, "0700.HK": 45.0,
            "005930.KS": 55.0, "066570.KQ": 75.0, "QCOM": 115.0, "AVGO": 820.0,
            "T": 16.0, "VZ": 33.0, "CMCSA": 41.0, "PYPL": 64.0, "SQ": 70.0,
            "UBER": 58.0, "ABNB": 130.0, "SPOT": 140.0, "ZM": 68.0, "SNOW": 180.0,
            "PLTR": 18.0, "COIN": 140.0, "MRNA": 115.0, "BNTX": 100.0, "RIVN": 15.0,
            "LCID": 5.0, "SNAP": 10.0, "PINS": 25.0, "SHOP": 70.0, "SE": 50.0,
            "ADYEY": 900.0, "ASML": 750.0, "PHG": 20.0, "HEIA.AS": 90.0, "BUD": 55.0,
            "GSK": 35.0, "AZN": 70.0, "SAN.PA": 85.0, "UBSG.SW": 22.0, "CSGN.SW": 1.0,
            "BNP.PA": 65.0, "GLE.PA": 24.0, "AIR.PA": 130.0, "SAF.PA": 140.0,
            "BN.PA": 60.0, "ENGI.PA": 13.0, "VIE.PA": 25.0, "ORA.PA": 10.0,
            "EN.PA": 30.0, "MT": 22.0, "VALE": 12.0, "PBR": 15.0, "ITUB": 6.0,
            "BBD": 4.0, "0241.HK": 8.0, "JD": 30.0, "3690.HK": 50.0
        };

        const actionDividends = {
            "AAPL": 0.92, "MSFT": 2.48, "AMZN": 0.00, "GOOGL": 0.00, "TSLA": 0.00,
            "META": 0.00, "NVDA": 0.40, "NFLX": 0.00, "INTC": 1.46, "CSCO": 1.56,
            "KO": 1.76, "PEP": 4.60, "NKE": 1.36, "MCD": 6.08, "WMT": 2.28,
            "BRK.B": 0.00, "V": 1.80, "MA": 2.28, "ADBE": 0.00, "CRM": 0.00,
            "AMD": 0.00, "BA": 0.00, "F": 0.60, "GM": 0.36, "DIS": 0.00,
            "PFE": 1.64, "JNJ": 4.76, "PG": 3.76, "UL": 1.82, "SHEL": 1.44,
            "CVX": 6.04, "XOM": 3.64, "TTE": 2.64, "MC.PA": 12.00, "NESN.SW": 2.80,
            "ROG.SW": 9.00, "NOVN.SW": 3.20, "SAP": 2.20, "VOW3.DE": 8.70,
            "BMW.DE": 5.80, "SONY": 0.40, "TM": 1.50, "BABA": 0.00, "0700.HK": 0.20,
            "005930.KS": 1.30, "066570.KQ": 1.00, "QCOM": 3.00, "AVGO": 18.40,
            "T": 1.11, "VZ": 2.61, "CMCSA": 1.16, "PYPL": 0.00, "SQ": 0.00,
            "UBER": 0.00, "ABNB": 0.00, "SPOT": 0.00, "ZM": 0.00, "SNOW": 0.00,
            "PLTR": 0.00, "COIN": 0.00, "MRNA": 0.00, "BNTX": 0.00, "RIVN": 0.00,
            "LCID": 0.00, "SNAP": 0.00, "PINS": 0.00, "SHOP": 0.00, "SE": 0.00,
            "ADYEY": 0.00, "ASML": 6.00, "PHG": 0.85, "HEIA.AS": 1.82, "BUD": 0.90,
            "GSK": 1.40, "AZN": 2.90, "SAN.PA": 3.56, "UBSG.SW": 0.70, "CSGN.SW": 0.10,
            "BNP.PA": 3.90, "GLE.PA": 1.70, "AIR.PA": 2.40, "SAF.PA": 2.00,
            "BN.PA": 2.00, "ENGI.PA": 1.00, "VIE.PA": 1.10, "ORA.PA": 0.70,
            "EN.PA": 1.80, "MT": 0.50, "VALE": 1.50, "PBR": 2.50, "ITUB": 0.35,
            "BBD": 0.18, "0241.HK": 0.00, "JD": 0.00, "3690.HK": 0.00
        };

        function updateFields() {
            const ticker = document.getElementById('action_name').value;
            document.getElementById('price_per_unit').value = actionPrices[ticker] ?? '';
            document.getElementById('dpa').value = (ticker in actionDividends) ? actionDividends[ticker] : '';
        }

        function updateSummary() {
            const ticker = document.getElementById('action_name').value;
            const quantity = document.getElementById('quantity').value || 0;
            const price = document.getElementById('price_per_unit').value || 0;
            const dpa = document.getElementById('dpa').value || 0;
            
            // Mise à jour des valeurs de résumé
            document.getElementById('summary-action').textContent = ticker ? 
                document.getElementById('action_name').options[document.getElementById('action_name').selectedIndex].text : '--';
            document.getElementById('summary-quantity').textContent = quantity;
            document.getElementById('summary-price').textContent = parseFloat(price).toFixed(2);
            document.getElementById('summary-total').textContent = (quantity * price).toFixed(2);
            document.getElementById('summary-dividend').textContent = (quantity * dpa).toFixed(2);
        }

        // Auto-dismiss flash messages si vous en avez
        document.addEventListener('DOMContentLoaded', function() {
            const flashMessages = document.querySelectorAll('.flash-message');
            flashMessages.forEach(message => {
                setTimeout(() => {
                    message.style.opacity = '0';
                    message.style.transition = 'opacity 0.5s ease';
                    setTimeout(() => {
                        message.remove();
                    }, 500);
                }, 5000);
            });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>